generator client {
    provider = "prisma-client-js"
    output   = "./generated"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model User {
    id        Int        @id @default(autoincrement())
    publicId  String     @unique
    githubId  Int        @unique
    role      Role       @default(user)
    name      String
    image     String
    createdAt DateTime   @default(now())
    updatedAt DateTime   @updatedAt
    products  Product[]
    cartItems CartItem[]
}

enum Role {
    user
    admin
}

model Product {
    id           Int        @id @default(autoincrement())
    publicId     String     @unique
    repositoryId Int        @unique
    name         String
    image        String
    price        Int
    userId       Int
    user         User       @relation(fields: [userId], references: [id])
    createdAt    DateTime   @default(now())
    updatedAt    DateTime   @updatedAt
    cartItems    CartItem[]
}

model CartItem {
    id        Int      @id @default(autoincrement())
    publicId  String   @unique
    userId    Int
    user      User     @relation(fields: [userId], references: [id])
    productId Int
    product   Product  @relation(fields: [productId], references: [id])
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    orders    Order[]
}

model Order {
    id         Int        @id @default(autoincrement())
    publicId   String     @unique
    orderId    String     @unique
    cartItemId Int
    status     Status
    createdAt  DateTime   @default(now())
    updatedAt  DateTime   @updatedAt
    cartItems  CartItem[]
}

enum Status {
    unpaid
    paid
}
